# OpenPatent 专利生成系统

## 简介

OpenPatent 是一个基于大语言模型的专利文档生成系统，旨在帮助用户快速生成高质量的专利文档，包括说明书、摘要和权利要求书。该系统通过上传参考专利文件和技术文档，利用向量数据库检索相关内容，并结合大语言模型生成符合专利撰写规范的文档。

## 主要功能

*   **参考专利上传与处理：** 用户可以上传参考专利文件（PDF 格式），系统会自动分割文件内容，并建立向量数据库，用于后续的相似内容检索。
*   **技术文档上传：** 用户可以上传技术文档（.docx 格式），作为生成专利文档的基础。
*   **专利文档生成：** 系统支持一键生成专利说明书、摘要和权利要求书。
*   **用户反馈与修订：** 用户可以对生成的文档提供反馈意见，系统会根据反馈内容进行文档修订，直到用户满意为止。
*   **文档保存：** 用户可以将满意的文档保存为 .docx 格式，方便后续编辑和使用。

## 安装

1.  **克隆代码仓库：**

    ```bash
    git clone <repository_url>
    cd OpenPatent
    ```
2.  **配置环境变量：**

    在使用 OpenPatent 之前，需要配置以下环境变量：

    *   `OPEN_ROUTER_KEY`：OpenRouter API 密钥 (从 [OpenRouter](https://openrouter.ai/) 获取).
    *   `SILICONFLOW_API_KEY`：SiliconFlow API 密钥 (从 [SiliconFlow](https://siliconflow.cn/) 获取).

    请将这些环境变量添加到您的系统环境变量中。
3.  **安装依赖：**

    在项目根目录下运行以下命令安装所需的 Python 依赖：

    ```bash
    pip install -r requirements.txt
    ```

## 使用

1.  **启动 Web UI：**
    运行 `web_ui.py` 启动 Gradio Web UI：

    ```bash
    python src/web_ui.py
    ```

    在浏览器中打开 Web UI 界面。
2.  **选择参考专利：**
    在 "1. 选择参考专利" 选项卡中，上传参考专利文件（PDF 格式）。点击 "处理专利文件" 按钮，系统会自动处理专利文件，并建立向量数据库。如果已经有本地知识库，可以点击 "已有本地知识库，点击这里" 按钮加载。
3.  **上传技术文档：**
    在 "2. 上传技术文档" 选项卡中，上传技术文档（.docx 格式）。
4.  **生成专利文档：**
    在 "3. 生成专利文档" 选项卡中，点击 "生成说明书"、"生成摘要" 或 "生成权利要求书" 按钮，系统会自动生成相应的专利文档。
5.  **用户反馈与修订：**
    在 "专利生成过程" 区域，查看生成的专利文档。如果需要修改，可以在 "修改意见" 文本框中输入修改意见，然后点击 "提交反馈" 按钮。系统会根据反馈内容进行文档修订。
6.  **文档保存：**
    如果对生成的文档满意，可以在 "修改意见" 文本框中输入 "满意"，然后点击 "提交反馈" 按钮。系统会将文档保存为 .docx 格式。

## 模块详解

### llm\_integration.py

该模块实现了与大语言模型的集成，用于生成和修订专利文档。

*   **PatentGenerator 类：**
    *   `__init__`：初始化专利生成器，设置 OpenAI API 密钥和基地址。
    *   `generate_draft`：根据给定的查询、上下文和文档类型生成专利文档初稿。
    *   `revise_draft`：根据用户反馈修订专利文档初稿。

### pdf\_processor.py

该模块用于处理 PDF 文件，将其按章节分割成多个部分。

*   **PDFProcessor 类：**
    *   `split_pdf`：将 PDF 文件按章节分割成多个部分，并返回一个字典，键为章节名，值为章节内容。

### vector\_db.py

该模块实现了向量数据库，用于创建、保存、加载和查询向量索引。

*   **VectorDB 类：**
    *   `__init__`：初始化向量数据库，设置数据库类型。
    *   `_get_embedding`：获取文本的嵌入向量。
    *   `create_index`：创建向量索引。
    *   `save_index`：保存向量索引到指定路径。
    *   `load_index`：从指定路径加载向量索引。
    *   `search`：根据查询文本搜索相关文本。
    *   `query`：根据查询文本查询相关文本。

### web\_ui.py

该模块实现了 Web 用户界面，用于创建和管理专利生成系统的用户界面。

*   **WebUI 类：**
    *   `__init__`：初始化网页用户界面。
    *   `init_interface`：初始化用户界面。
    *   `process_patents`：处理上传的参考专利文件，创建向量数据库并保存索引。
    *   `load_existing_db`：加载已有的本地知识库。
    *   `generate_specification`：生成专利说明书。
    *   `generate_abstract`：生成专利摘要。
    *   `generate_claims`：生成专利权利要求书。
    *   `_generate_draft`：生成专利文档初稿。
    *   `submit_feedback`：提交用户反馈，根据反馈内容进行文档保存或修订。

## 贡献

欢迎参与 OpenPatent 项目的开发和改进！请提交 Pull Request，并详细描述您的修改内容和目的。

## 特别鸣谢

AI代码编辑器[Trae](https://www.trae.ai/) 在本项目开发过程中起到了巨大的作用，使得本项目得以在短时间内实现。

## 许可证

[MIT](LICENSE)
